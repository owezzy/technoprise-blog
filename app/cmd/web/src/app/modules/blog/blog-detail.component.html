<div class="flex min-w-0 flex-auto flex-col min-h-screen">
    <!-- Loading -->
    <div *ngIf="loading" class="flex items-center justify-center min-h-96">
        <mat-spinner diameter="40"></mat-spinner>
    </div>

    <!-- Error -->
    <div *ngIf="error && !loading" class="flex items-center justify-center min-h-96">
        <fuse-alert
            [appearance]="'outline'"
            [showIcon]="false"
            [type]="'error'"
            [dismissible]="true"
            (dismissedChanged)="clearError()">
            {{ error }}
        </fuse-alert>
    </div>

    <!-- Blog Post Content -->
    <div *ngIf="post && !loading" class="flex min-w-0 flex-auto flex-col pb-0">
        <!-- Header with Back Button -->
        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between p-6 sm:p-8 border-b bg-card gap-4">
            <button
                mat-button
                (click)="navigateBack()"
                class="flex items-center gap-2 text-secondary hover:text-primary transition-colors self-start">
                <mat-icon>arrow_back</mat-icon>
                Back to Blog Posts
            </button>

            <div class="flex flex-col sm:flex-row sm:items-center gap-4">
                <div class="text-sm text-secondary">
                    {{ formatDate(post.published_at) }}
                </div>
                <button
                    mat-flat-button
                    [color]="'primary'"
                    [routerLink]="['/blog/edit', post.id]"
                    class="flex items-center w-full sm:w-auto justify-center">
                    <mat-icon class="mr-2">edit</mat-icon>
                    Edit
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex-auto">
            <!-- Featured Image -->
            <div class="relative h-64 sm:h-80 lg:h-96 overflow-hidden bg-gray-100 dark:bg-gray-800">
                <img
                    *ngIf="post.featured_image; else placeholderImage"
                    [src]="getImageUrl(post.featured_image.filename)"
                    [alt]="post.featured_image.alt_text || post.title"
                    class="w-full h-full object-cover">
                <ng-template #placeholderImage>
                    <div class="w-full h-full bg-gradient-to-br from-primary-500 to-accent-500 flex items-center justify-center">
                        <mat-icon class="text-on-primary text-6xl">article</mat-icon>
                    </div>
                </ng-template>
            </div>

            <!-- Article Content -->
            <div class="max-w-4xl mx-auto p-6 sm:p-8 lg:p-12">
                <!-- Article Header -->
                <header class="mb-8">
                    <h1 class="text-3xl sm:text-4xl lg:text-5xl font-bold leading-tight mb-6">
                        {{ post.title }}
                    </h1>

                    <div class="flex items-center gap-4 text-sm text-secondary mb-6">
                        <div class="flex items-center gap-2">
                            <mat-icon class="text-hint" style="font-size: 16px; height: 16px; width: 16px;">schedule</mat-icon>
                            <time [attr.datetime]="post.published_at">
                                {{ formatDate(post.published_at) }}
                            </time>
                        </div>
                        <span class="w-1 h-1 bg-gray-400 rounded-full"></span>
                        <span>{{ calculateReadingTime(post.content) }} min read</span>
                    </div>

                    <!-- Excerpt -->
                    <p *ngIf="post.excerpt" class="text-lg text-secondary leading-relaxed mb-6">
                        {{ post.excerpt }}
                    </p>
                </header>

                <!-- Article Body -->
                <article class="prose prose-lg max-w-none dark:prose-invert">
                    <div class="whitespace-pre-wrap leading-relaxed" [innerHTML]="post.content"></div>
                </article>
            </div>

        </div>
    </div>

    <!-- Footer - Sticky at bottom -->
    <footer class="sticky bottom-0 flex flex-0 items-center justify-start w-full h-14 px-4 md:px-6 z-49 border-t bg-card dark:bg-transparent print:hidden mt-auto">
        <span class="font-medium text-secondary">TG Blog &copy; {{ currentYear }}</span>
    </footer>
</div>
